mutate(THI=tempC+(.36*dewC)+41.2)%>%
mutate(THI2=tempF-.55*((1-relhum/100)*(tempF-58)))%>%
mutate(date=as.character(date))%>%
mutate(date=mdy_hm(date))%>%
mutate(md=paste(lubridate::month(date), lubridate::mday(date), sep="/"))%>%
mutate(md=md(md))
s24a<-s24%>%
mutate(tempC=(tempF-32)*5/9, dewC=(dewF-32)*5/9)%>%
mutate(THI=tempC+(.36*dewC)+41.2)%>%
mutate(THI2=tempF-.55*((1-relhum/100)*(tempF-58)))%>%
mutate(date=as.character(date))%>%
mutate(date=mdy_hm(date))%>%
mutate(md=paste(lubridate::month(date), lubridate::mday(date), sep="/"))%>%
mutate(md=mdy(date))
s24a<-s24%>%
mutate(tempC=(tempF-32)*5/9, dewC=(dewF-32)*5/9)%>%
mutate(THI=tempC+(.36*dewC)+41.2)%>%
mutate(THI2=tempF-.55*((1-relhum/100)*(tempF-58)))%>%
mutate(date=as.character(date))%>%
mutate(date=mdy_hm(date))%>%
mutate(mdyr=paste(lubridate::month(date), lubridate::mday(date), lubridate::year(date), sep="/"))%>%
mutate(mdyr=mdy(md))
s24a<-s24%>%
mutate(tempC=(tempF-32)*5/9, dewC=(dewF-32)*5/9)%>%
mutate(THI=tempC+(.36*dewC)+41.2)%>%
mutate(THI2=tempF-.55*((1-relhum/100)*(tempF-58)))%>%
mutate(date=as.character(date))%>%
mutate(date=mdy_hm(date))%>%
mutate(mdyr=paste(lubridate::month(date), lubridate::mday(date), lubridate::year(date), sep="/"))%>%
mutate(mdyr=mdy(mdyr))
s24sum<-s24a%>%
group_by(mdyr)%>%
summarize(meanHI=mean(THI2), maxHI=max(THI2))
ggplot(s24a, aes(x=date, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+#geom_point(aes(x=date, y=THI), size=.25, color="blue")
ggplot(s24a, aes(x=date, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+#geom_point(aes(x=date, y=THI), size=.25, color="blue")
ggplot(s24a, aes(x=date, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+#geom_point(aes(x=date, y=THI), size=.25, color="blue")
ggplot(s24a, aes(x=date, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")#geom_point(aes(x=date, y=THI), size=.25, color="blue")
ggplot(s24a, aes(x=date, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))
rlang::last_trace()
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI))
mutate(cat=ifelse(maxTHI2>89, "emergency", ifelse(maxTHI2>79, "danger", ifelse(maxTHI2>72, "alert", "none") ))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
s24sum<-s24a%>%
group_by(mdyr)%>%
summarize(meanHI=mean(THI2), maxHI=max(THI2))%>%
mutate(cat=ifelse(maxTHI2>89, "emergency", ifelse(maxTHI2>79, "danger", ifelse(maxTHI2>72, "alert", "none") )))
s24sum<-s24a%>%
group_by(mdyr)%>%
summarize(meanHI=mean(THI2), maxHI=max(THI2))%>%
mutate(cat=ifelse(maxHI>89, "emergency", ifelse(maxHI>79, "danger", ifelse(maxHI>72, "alert", "none") )))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(breaks="day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(breaks=d)+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(breaks=scales::date_breaks("day"))+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(breaks=scales::date_breaks("1 day"))+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(date_breaks("1 day"))+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime("Date", date_breaks("1 day"))+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime("Date", date_breaks="1 day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_datetime(date_breaks="1 day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_date(date_breaks="1 day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_date(date_breaks="1 day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))+
+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_date(date_breaks="1 day")+scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_x_date(date_breaks="1 day", labels=date_format("md"))+scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
+scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))# scale_x_date(date_breaks="1 day", labels=date_format("md"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+ geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) # scale_x_date(date_breaks="1 day", labels=date_format("md"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) # scale_x_date(date_breaks="1 day", labels=date_format("md"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="1 day", labels=date_format("m"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="1 day", labels=date_format("m"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="1 day", labels=date_format("md"))
library(lubridate)
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="1 day", labels=date_format("md"))
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="7 day")
ggplot(s24a, aes(x=mdyr, y=THI2))+geom_point(size=.25)+geom_hline(yintercept=72, color="yellow")+
geom_hline(yintercept=79, color="orange")+ geom_hline(yintercept=89, color="red")+
# geom_point(data=s24sum, aes(x=mdyr, y=meanHI))+
geom_point(data=s24sum, aes(x=mdyr, y=maxHI, color=cat))+
scale_color_manual(values=c("yellow", "orange", "red", "black"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + scale_x_date(date_breaks="15 day")
# Read in data
willowperform <- read.csv("Willow Performance Data(TidyData).csv")
# Read in data
willowperform <- read.csv("Willow Performance Data(TidyData).csv")
# Add libraries (first is for plots, second is for editing data)
library(ggplot2)
library(dplyr)
library(tidyverse)
# New column combining month and year
willowperform$month_year <- paste(willowperform$month, willowperform$year)
# Remove unnecessary columns
willowperform <- willowperform %>%
select(-protected, -death, -browse, -X, -X.1)
# Plot: Willow height by all factors
ggplot(willowperform, aes(x = species, y = height_cm, fill = plantingtype)) +
geom_boxplot() +
facet_wrap(~ field) +
scale_fill_manual(
values = c("Rooted" = "turquoise4", "Staked" = "violetred3")) +
labs(title = "Willow height by species, method, and location")
# Plot: Violin graph of height distribution by field
ggplot(willowperform, aes(x = field, y = height_cm, fill = field)) +
geom_violin(trim = FALSE) +
labs(title = "Height Distribution by Field",
x = "Field", y = "Height (cm)") +
theme_minimal()
# Plot: Height by field and planting type
ggplot(willowperform, aes(x = field, y = height_cm, fill = plantingtype)) +
geom_boxplot(position = position_dodge()) +
labs(title = "Height by Field and Planting Type",
x = "Field", y = "Height (cm)") +
theme_minimal()
# Reorder
month_year_order <- c("March 2024", "May 2024", "July 2024", "October 2024",
"April 2025","July 2025", "August 2025", "October 2025")
# Fix month order
willowperform <- willowperform %>%
mutate(month_year = factor(month_year, levels = month_year_order))
# Summarize data
willow_summary <- willowperform %>%
group_by(month_year) %>%
summarise(mean_height = mean(height_cm, na.rm = TRUE))
# Plot: Height overtime
ggplot(willow_summary, aes(x = month_year, y = mean_height, group = 1)) +
geom_line(color = "forestgreen", linewidth = 1.2) +
geom_point() +
labs(title = "Average Plant Height Over Time",
x = "Month/Year", y = "Average Height (cm)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Plot: Average Height overtime by field and species
ggplot(willowperform, aes(x = month_year, y = height_cm,
color = species, group = species)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
# average height per time point
stat_summary(fun = mean, geom = "point", size = 2) +
# optional: add points
facet_wrap(~ field) +
scale_color_manual(values = c( "discolor"= "gold",
"lucida" = "salmon",
"purpurea" = "mediumorchid2",
"sericea"  = "turquoise3")) +
labs(title = "Average Willow Height Growth Over Time by Field and Species",
x = "Month and Year",
y = "Average Height (cm)",
color = "Species") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(willowperform)
# Define standard error function for error bars
se_function <- function(x) {
sd(x, na.rm = TRUE) / sqrt(length(x[!is.na(x)]))
}
# Plot: Willow Height Growth Over Time by Species and Field
ggplot(willowperform, aes(x = month_year, y = height_cm,
color = species,
group = interaction(species, field))) +
# Mean line
stat_summary(fun = mean, geom = "line", size = 0.8) +
# Mean point
stat_summary(fun = mean, geom = "point", size = 1.5) +
# Error bars (Â± SE)
stat_summary(fun.data = function(y) {
data.frame(
y = mean(y, na.rm = TRUE),
ymin = mean(y, na.rm = TRUE) - se_function(y),
ymax = mean(y, na.rm = TRUE) + se_function(y)
)
}, geom = "errorbar", width = 0.2, aes(color = NULL), color = "grey30", size = 0.4) +
scale_color_manual(values = c(
"discolor"= "gold",
"lucida" = "salmon",
"purpurea" = "mediumorchid2",
"sericea"  = "turquoise3"
)) +
labs(title = "Willow Height Growth Over Time by Species and Field",
x = "Month and Year",
y = "Height (cm)",
color = "Species") +
theme_minimal(base_size = 13) +
facet_wrap(~ field) +
theme(
panel.grid.minor = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "right",
plot.title = element_text(face = "bold", size = 14)
)
# Adding library to fix date
library(lubridate)
# Turn month and year into a readable date
willowperform <- willowperform %>%
mutate(date_real = ymd(paste(year, month, "01")))
# Plot: Willows Average Height Overtime (Correctly spaced out)
ggplot(willowperform, aes(
x = date_real,
y = height_cm,
color = species,
linetype = plantingtype,
group = interaction(species, plantingtype)
)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
stat_summary(fun = mean, geom = "point", size = 2) +
facet_wrap(~ field) +
scale_x_date(date_labels = "%b %Y", date_breaks = "3 months") +
labs(title = "Willows Average Height Overtime",
x = "Date",
y = "Average Height (cm)",
color = "Species",
linetype = "Planting Type"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Summarize data by height & field
height_field <- willowperform %>%
group_by(month_year, field) %>%
summarise(mean_height = mean(height_cm, na.rm = TRUE))
# Plot: Average height overtime by field
ggplot(height_field, aes(x = month_year, y = mean_height,
color = field, group = field)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Average Willow Height Over Time by Field",
x = "Month / Year",
y = "Average Height (cm)",
color = "Field"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Summarize data by height and planting type
height_type <- willowperform %>%
group_by(month_year, plantingtype) %>%
summarise(mean_height = mean(height_cm, na.rm = TRUE))
# Plot: Height by planting type
ggplot(height_type, aes(x = month_year, y = mean_height,
color = plantingtype, group = plantingtype)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Average Willow Height Over Time by Planting Type",
x = "Month / Year",
y = "Average Height (cm)",
color = "Planting Type"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Summarize data by stems & field
stems_field <- willowperform %>%
group_by(month_year, field) %>%
summarise(mean_stems = mean(stems, na.rm = TRUE))
# Plot: Stems by field overtime
ggplot(stems_field, aes(x = month_year, y = mean_stems,
color = field, group = field)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Average Number of Stems Over Time by Field",
x = "Month / Year",
y = "Average Number of Stems",
color = "Field"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Summarize data by stems & planting type
stems_type <- willowperform %>%
group_by(month_year, plantingtype) %>%
summarise(mean_stems = mean(stems, na.rm = TRUE))
# Plot: Stems by planting type overtime
ggplot(stems_type, aes(x = month_year, y = mean_stems,
color = plantingtype, group = plantingtype)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Average Number of Stems Over Time by Planting Type",
x = "Month / Year",
y = "Average Number of Stems",
color = "Planting Type"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Fix date column to classify as date
willowperform$date <- as.Date(willowperform$date, format = "%m/%d/%Y")
# New table with planting dates
start_dates <- willowperform %>%
group_by(field, plantingtype, species) %>%
summarise(start_date = min(date, na.rm = TRUE)) %>%
ungroup()
# New table combining age dates
willow_age <- willowperform %>%
left_join(start_dates, by = c("field", "species", "plantingtype"))
# Calculating age by days, weeks, and months
willow_age <- willow_age %>%
mutate(age_days = as.numeric(difftime(date, start_date, units = "days")),
age_weeks = age_days / 7,
age_months = age_days / 30.44)
# Plot: Height by age (weeks)
ggplot(willow_age, aes(x = age_weeks, y = height_cm,
color = species, linetype = plantingtype)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
facet_wrap(~ field) +
labs(title = "Willow Height Growth by Age (Weeks)",
x = "Age (weeks since first measurement)",
y = "Height (cm)",
color = "Species",
linetype = "Planting Type") +
theme_minimal(base_size = 13)
View(willow_age)
# Plot: Average height overtime by field
ggplot(height_field, aes(x = month_year, y = mean_height,
color = field, group = field)) +
geom_line(size = 1) +
geom_point() +
labs(
title = "Average Willow Height Over Time by Field",
x = "Month / Year",
y = "Average Height (cm)",
color = "Field"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Plot: Willows Average Height Overtime (Correctly spaced out)
ggplot(willowperform, aes(
x = date_real,
y = height_cm,
color = species,
linetype = plantingtype,
group = interaction(species, plantingtype)
)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
stat_summary(fun = mean, geom = "point", size = 2) +
facet_wrap(~ field) +
scale_x_date(date_labels = "%b %Y", date_breaks = "3 months") +
labs(title = "Willows Average Height Overtime",
x = "Date",
y = "Average Height (cm)",
color = "Species",
linetype = "Planting Type"
) +
theme_minimal(base_size = 13) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Plot: Height by age (weeks)
ggplot(willow_age, aes(x = age_weeks, y = height_cm,
color = species, linetype = plantingtype)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
facet_wrap(~ field) +
labs(title = "Willow Height Growth by Age (Weeks)",
x = "Age (weeks since first measurement)",
y = "Height (cm)",
color = "Species",
linetype = "Planting Type") +
theme_minimal(base_size = 13)
#Willow Survival Rates
library(tidyverse)
SurvivalRates<- read_csv("SurvivalRates3.csv")%>%
mutate(season=paste(Season, Year, sep="_"))%>%
mutate(season=factor(season, levels = c("Fall_2023","Spring_2024","Summer_2024","Fall_2024","Spring_2025")))%>%
mutate(percent=Count/FirstCount*100)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= ((Count)), color= Species, shape=Tube))+
geom_jitter(width=.15) +
labs(y="Survivors", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= ((percent)), color= Species, shape=Field))+
geom_jitter(width=.15) +
labs(y="% Survivors", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= ((percent)), color= Species, shape=Field))+
geom_jitter(width=.15) +
labs(y="% Survivors", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= ((Count)), color= Species, shape=Tube))+
geom_jitter(width=.15) +
labs(y="Survivors", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= ((percent)), color= Species, shape=Field))+
geom_jitter(width=.15) +
labs(y="% Survivors", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= (1/(Count/80)), color= Species, shape=Tube))+
geom_jitter(width=.15)+scale_y_log10()+
labs(y="Row Spacing (in ft)", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= (1/(Count/80)), color= Species, shape=Field))+
geom_jitter(width=.15)+scale_y_log10()+
labs(y="Row Spacing (in ft)", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= (1/(Count/80)), color= Species, shape=Tube))+
geom_jitter(width=.15)+scale_y_log10()+
labs(y="Row Spacing (in ft)", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= (1/(Count/80)), color= Species, shape=Field))+
geom_jitter(width=.15)+scale_y_log10()+
labs(y="Row Spacing (in ft)", color="Legend")+ facet_wrap(~PlantingType)
ggplot(
data= SurvivalRates,
mapping= aes(x=season, y= (1/(Count/80)), color= Species, shape=Tube))+
geom_jitter(width=.15)+scale_y_log10()+
labs(y="Row Spacing (in ft)", color="Legend")+ facet_wrap(~PlantingType)
# Plot: Height by age (weeks)
ggplot(willow_age, aes(x = age_weeks, y = height_cm,
color = species, linetype = plantingtype)) +
stat_summary(fun = mean, geom = "line", size = 1.2) +
facet_wrap(~ field) +
labs(title = "Willow Height Growth by Age (Weeks)",
x = "Age (weeks since first measurement)",
y = "Height (cm)",
color = "Species",
linetype = "Planting Type") +
theme_minimal(base_size = 13)
